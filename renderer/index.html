<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Controle de Luz Tuya</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="widget-container">
      <!-- Cabeçalho com controles de janela -->
      <header class="widget-header">
        <div class="header-left">
          <h1><i class="fas fa-lightbulb"></i> Tuya</h1>
        </div>
        <div class="header-actions">
          <button class="icon-btn" onclick="toggleAuth()" title="Autenticação">
            <i class="fas fa-key"></i>
          </button>
          <button class="icon-btn" onclick="refreshDevices()" title="Atualizar">
            <i class="fas fa-sync-alt"></i>
          </button>
          <button
            class="icon-btn window-control"
            onclick="toggleAlwaysOnTop()"
            title="Fixar"
          >
            <i class="fas fa-thumbtack"></i>
          </button>
          <button
            class="icon-btn window-control"
            onclick="minimizeWidget()"
            title="Minimizar"
          >
            <i class="fas fa-minus"></i>
          </button>
          <button
            class="icon-btn window-control close-btn"
            onclick="closeWidget()"
            title="Fechar"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
      </header>

      <!-- Autenticação -->
      <div class="auth-section" id="authSection" style="display: none">
        <div class="auth-form">
          <input
            type="text"
            id="username"
            placeholder="Login"
            class="auth-input"
          />
          <input
            type="password"
            id="password"
            placeholder="Senha"
            class="auth-input"
          />
          <select id="region" class="auth-select">
            <option value="44">EU</option>
            <option value="1">US</option>
            <option value="86">CN</option>
          </select>
          <select id="platform" class="auth-select">
            <option value="smart_life">Smart Life</option>
            <option value="tuya">Tuya</option>
          </select>
          <div class="auth-buttons">
            <button class="btn-primary" onclick="doLogin()">Entrar</button>
            <button class="btn-secondary" onclick="importAuth()">
              Importar
            </button>
          </div>
          <label class="checkbox-label">
            <input type="checkbox" id="saveAuth" checked />
            <span class="checkmark"></span>
            Salvar
          </label>
        </div>
        <div id="loginFailed" class="error-message" style="display: none"></div>
      </div>

      <!-- Seleção de dispositivo -->
      <div class="device-section">
        <select id="deviceSelect" class="device-select">
          <option value="">Selecione um dispositivo</option>
        </select>
      </div>

      <!-- Controle -->
      <div class="control-section" id="controlSection" style="display: none">
        <!-- Informações do dispositivo -->
        <div class="device-info">
          <div class="device-status">
            <span class="status-indicator" id="statusIndicator"></span>
            <span class="device-name" id="deviceName"></span>
          </div>
          <div class="device-details" id="deviceDetails">
            <span
              class="detail-item"
              id="brightnessDetail"
              style="display: none"
              >Brilho: <span id="deviceBrightness">-</span></span
            >
            <span class="detail-item" id="deviceTypeDetail"></span>
          </div>
        </div>

        <!-- Controle de brilho (apenas para lights) -->
        <div class="control-group" id="brightnessControl" style="display: none">
          <div class="control-label">
            <i class="fas fa-sun"></i>
            <span>Brilho</span>
            <span class="control-value" id="brightnessValue">100%</span>
          </div>
          <input
            type="range"
            id="brightnessSlider"
            class="slider"
            min="0"
            max="100"
            value="100"
          />
        </div>

        <!-- Controle de cor (apenas para lights) -->
        <div class="control-group" id="colorControl" style="display: none">
          <div class="control-label">
            <i class="fas fa-palette"></i>
            <span>Cor</span>
            <span class="control-value" id="colorValue">#FFFFFF</span>
          </div>
          <input
            type="range"
            id="hueSlider"
            class="slider color-slider"
            min="0"
            max="360"
            value="0"
          />
        </div>

        <!-- Ações rápidas -->
        <div class="quick-actions" id="quickActions">
          <button class="quick-btn" onclick="quickAction('on')" title="Ligar">
            <i class="fas fa-power-off"></i>
          </button>
          <button
            class="quick-btn hold-btn"
            id="offBtn"
            data-action="off"
            title="Mantenha pressionado para desligar"
          >
            <i class="fas fa-power-off"></i>
            <div class="hold-progress"></div>
          </button>
          <!-- Botão de reboot (apenas para switches) -->
          <button
            class="quick-btn reboot-btn hold-btn"
            id="rebootBtn"
            data-action="reboot"
            title="Mantenha pressionado para reiniciar (desliga e liga após 30s)"
            style="display: none"
          >
            <i class="fas fa-redo"></i>
            <div class="hold-progress"></div>
          </button>
          <!-- Botões de brilho (apenas para lights) -->
          <button
            class="quick-btn"
            id="brightBtn"
            onclick="quickAction('bright')"
            title="Brilhante"
            style="display: none"
          >
            <i class="fas fa-sun"></i>
          </button>
          <button
            class="quick-btn"
            id="dimBtn"
            onclick="quickAction('dim')"
            title="Escuro"
            style="display: none"
          >
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </div>

      <!-- Estado de carregamento -->
      <div class="loading" id="loading" style="display: none">
        <div class="spinner"></div>
        <p>Carregando...</p>
      </div>

      <!-- Mensagens -->
      <div class="message-container">
        <div class="error-message" id="errorMessage"></div>
        <div class="success-message" id="successMessage"></div>
      </div>

      <!-- Dica sobre atalhos de teclado -->
      <div class="hotkey-hint">
        <small>Alt+W - mostrar/ocultar widget</small>
      </div>
    </div>

    <script src="widget.js"></script>
  </body>
</html>
